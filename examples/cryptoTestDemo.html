<!DOCTYPE html>
<html>
<head>
  <title>CryptoJS Example</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/forge/0.10.0/forge.min.js"></script>

</head>
<body>
  <h1>CryptoJS Example</h1>

  <label for="message">Message:</label>
  <textarea id="message" rows="25" cols="50">397617AFC2B5AD3C0405EF727EB09030A3D3035B114A1A3D257C7C946F762A4146DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E0346DCED0E672F3B70AE1276A3F8712E03</textarea>

  <label for="key">Encryption Key:</label>
  <input type="text" id="key"  value="71776572747975696F70617364666768"/>

  <button onclick="decryptMessage()">Decrypt</button>

  <h2>Encrypted Message:</h2>
  <div id="encrypted"></div>

  <h2>Decrypted Message:</h2>
  <textarea id="res" rows="25" cols="50"></textarea>

  <script>

function hexToUint8Array(hexString) {
  const byteLength = hexString.length / 2;
  const uint8Array = new Uint8Array(byteLength);

  for (let i = 0; i < byteLength; i++) {
    const hexByte = hexString.substr(i * 2, 2);
    uint8Array[i] = parseInt(hexByte, 16);
  }

  return uint8Array;
}

// Example usage:


function myDecrypt(inputBuffer, keyBytes, iv) {
  return window.crypto.subtle.importKey(
    'raw',
    keyBytes,
    { name: 'AES-CBC', length: 128 },
    false,
    ['decrypt']
  )
  .then(importedKey => {
    return window.crypto.subtle.decrypt(
      { name: 'AES-CBC', iv: iv },
      importedKey,
      inputBuffer
    );
  })
  .then(decryptedBuffer => {
    const decryptedData = new Uint8Array(decryptedBuffer);
    return decryptedData;
  });
}

    function decryptMessage() {
      var msg = document.getElementById('encrypted').innerText;
      var res = document.getElementById('res');
      var key = document.getElementById('key').value;
      let iv = 'B0351FE3622D44A0815CCBF8C9760991';

     
        // Convert the key and IV to Forge's byte buffers
        var keyBytes = hexToUint8Array(key);
        var ivBytes = hexToUint8Array(iv);

        // Convert the encrypted message to Forge's byte buffer
        var encryptedBytes = hexToUint8Array(msg);


        // Get the decrypted message as a string
        var decrypted = myDecrypt(encryptedBytes,keyBytes,ivBytes );

        // Display the decrypted message
        //res.innerText = decrypted;
    }
  </script>
</body>
</html>
